<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fetch Played Players</title>
  </head>
  <body>
    <div id="fetchPlayerForm">
      <h2>Fetch Played Players</h2>
      <input type="text" id="player_username" placeholder="Player Username" />
      <button onclick="fetchPlayedPlayers()">Fetch</button>
    </div>
    <button onclick="goBack()">Back to Home</button>
    <div id="apiResponse">Response will appear here...</div> 

    <script>
      async function fetchPlayedPlayers() {
        const username = document.getElementById("player_username").value;

        const response = await fetch(
          "http://localhost:8000/get-played-player/",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ username: username }),
          }
        );

        if (response.ok) {
          const data = await response.json();
          let playedWith = data.played_with
            .map((player) => `${player.name} ${player.surname}`)
            .join(", ");
          let mostFrequent = data.most_frequent
            .map(
              (player) =>
                `${player.name} ${player.surname} (${player.count} times)`
            )
            .join(", ");
          let averageHeight = data.average_height;

          document.getElementById("apiResponse").innerHTML = `
            <p>Players Played With: ${playedWith}</p>
            <p>Most Frequent Player: ${mostFrequent}</p>
            <p>Average Height: ${averageHeight} cm</p>
        `;
        } else {
          const errorText = await response.text();
          document.getElementById("apiResponse").innerHTML =
            "No player is found."
        }
      }

      function goBack() {
        window.location.href = "index.html"; 
      }
    </script>
  </body>
</html>
